/*******************************************************************************
 * Educational Online Test Delivery System
 * Copyright (c) 2013 American Institutes for Research
 * 
 * Distributed under the AIR Open Source License, Version 1.0
 * See accompanying file AIR-License-1_0.txt or at
 * http://www.smarterapp.org/documents/American_Institutes_for_Research_Open_Source_Software_License.pdf
 ******************************************************************************/
package org.opentestsystem.shared.web;

import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;

import org.slf4j.LoggerFactory;

import ch.qos.logback.classic.LoggerContext;

/**
 * A Servlet listener used to shutdown Logback when the webapp is shutdown.
 * This will help avoid memory leaks if the app is shutdown and the JVM isn't
 * but it is also the only way to correctly remove the Logback entry in JMX.
 */
public class LogbackManagementListener implements ServletContextListener {

    @Override
    public void contextInitialized(final ServletContextEvent sce) {
        // nothing for initialization

    }

    @Override
    public void contextDestroyed(final ServletContextEvent sce) {
        LoggerContext logContext = (LoggerContext) LoggerFactory.getILoggerFactory();
        logContext.stop();
    }

}
